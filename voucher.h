#ifndef VOUCHER_H
#define VOUCHER_H

#include <mach/mach.h>

// From mach_voucher_types.h
#define MACH_VOUCHER_ATTR_MAX_RAW_RECIPE_ARRAY_SIZE 5120
#define MAX_MULTIPLE_REDEEM_RECIPES MACH_VOUCHER_ATTR_MAX_RAW_RECIPE_ARRAY_SIZE / sizeof(mach_voucher_attr_recipe_data_t) // 320

mach_voucher_attr_recipe_t create_voucher_recipe(size_t content_size, uint64_t id);
mach_port_t create_voucher(size_t content_size, mach_voucher_attr_recipe_t recipe);
mach_port_t redeem_voucher(mach_port_t previous_voucher);
mach_voucher_attr_recipe_t multiple_redeem_voucher_recipe(mach_port_t previous_voucher, int number_of_recipes);
mach_port_t multiple_redeem_voucher(mach_voucher_attr_recipe_t recipe, int number_of_recipes);
void release_voucher(mach_port_t voucher_port);

#endif