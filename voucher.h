#ifndef VOUCHER_H
#define VOUCHER_H

#include <mach/mach.h>

#define MULTIPLE_REDEEM_RECIPES 256

// From mach_voucher_types.h
#define MACH_VOUCHER_ATTR_MAX_RAW_RECIPE_ARRAY_SIZE 5120

mach_voucher_attr_recipe_t create_voucher_recipe(size_t content_size, uint64_t id);
mach_port_t create_voucher(mach_port_t host, size_t content_size, mach_voucher_attr_recipe_t recipe);
mach_port_t redeem_voucher(mach_port_t host, mach_port_t previous_voucher);
mach_port_t multiple_redeem_voucher(mach_port_t host, size_t content_size, uint64_t id, mach_port_t previous_voucher);
void release_voucher(mach_port_t voucher_port);

#endif