#ifndef HELPER_H
#define HELPER_H

#include <stdio.h>
#include <stdlib.h>
#include <Foundation/Foundation.h>

#define LOG_LOG(tag, fmt, ...) NSLog((@"[%c] %s: " fmt), tag, __func__, ##__VA_ARGS__); fflush(stderr)

#define ERROR_LOG(fmt, ...) LOG_LOG('!', fmt, ##__VA_ARGS__)
#define INFO_LOG(fmt, ...) LOG_LOG('+', fmt, ##__VA_ARGS__)

#ifdef DEBUG
#define DEBUG_LOG(fmt, ...) LOG_LOG('+', fmt, ##__VA_ARGS__)
#else
#define DEBUG_LOG(fmt, ...)
#endif

#define SECOND 1

#define E_SIZE_OFFSET 0x4
#define E_CONTENT_OFFSET 0x20

#define N_BEFORE_PORTS 1
#define N_AFTER_PORTS 1

void hexdump(const void* data, size_t size);
void prepare_spray_buf(uint8_t ***buf, size_t *buf_len, size_t spray_size, uint32_t e_size);
int prepare_ports(mach_port_t **before_ports, mach_port_t **after_ports,
                  mach_port_t *target_port);
int destroy_ports(mach_port_t *before_ports, mach_port_t *after_ports,
                  mach_port_t target_port);                  
#endif